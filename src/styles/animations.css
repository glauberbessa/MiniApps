/**
 * MiniApps Animation System
 *
 * Sistema centralizado de animações para Motion e Micro-interações.
 * Fase 3 do plano de refatoração UI.
 *
 * Categorias:
 * 1. Easings e Durações
 * 2. Keyframes Base
 * 3. Animações de Entrada
 * 4. Feedback de Ações
 * 5. Hover States
 * 6. Suporte a prefers-reduced-motion
 */

/* ==========================================
 * ANIMATION TOKENS
 * ========================================== */

:root {
  /* Durações */
  --anim-duration-instant: 100ms;
  --anim-duration-fast: 150ms;
  --anim-duration-normal: 300ms;
  --anim-duration-slow: 500ms;
  --anim-duration-slower: 700ms;
  --anim-duration-slowest: 1000ms;

  /* Easings - Curvas de animação expressivas */
  --ease-out-expo: cubic-bezier(0.16, 1, 0.3, 1);
  --ease-out-quint: cubic-bezier(0.22, 1, 0.36, 1);
  --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
  --ease-in-out-expo: cubic-bezier(0.87, 0, 0.13, 1);
  --ease-spring: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);

  /* Delays para Stagger */
  --stagger-step: 80ms;
  --stagger-step-fast: 50ms;
  --stagger-step-slow: 120ms;
}

/* ==========================================
 * KEYFRAMES BASE - ENTRADA
 * ========================================== */

/* Fade simples */
@keyframes anim-fade-in {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes anim-fade-out {
  from { opacity: 1; }
  to { opacity: 0; }
}

/* Fade com movimento vertical */
@keyframes anim-fade-in-up {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes anim-fade-in-down {
  from {
    opacity: 0;
    transform: translateY(-20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* Fade com movimento horizontal */
@keyframes anim-fade-in-left {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes anim-fade-in-right {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Scale com fade */
@keyframes anim-scale-in {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes anim-scale-in-center {
  from {
    opacity: 0;
    transform: scale(0.5);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

/* Unfold - Efeito de "desdobrar" para cards editoriais */
@keyframes anim-unfold {
  from {
    opacity: 0;
    transform: translateY(40px) rotateX(-15deg);
  }
  to {
    opacity: 1;
    transform: translateY(0) rotateX(0);
  }
}

/* Wave - Entrada em onda para dashboards */
@keyframes anim-wave {
  from {
    opacity: 0;
    transform: translateY(24px) scale(0.96);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

/* ==========================================
 * KEYFRAMES BASE - FEEDBACK DE AÇÕES
 * ========================================== */

/* Shake para erros */
@keyframes anim-shake {
  0%, 100% { transform: translateX(0); }
  10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
  20%, 40%, 60%, 80% { transform: translateX(4px); }
}

/* Shake suave */
@keyframes anim-shake-subtle {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  50% { transform: translateX(2px); }
  75% { transform: translateX(-2px); }
}

/* Pulse vermelho para erros */
@keyframes anim-error-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(239, 68, 68, 0);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(239, 68, 68, 0.15);
  }
}

/* Pulse de sucesso */
@keyframes anim-success-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0);
  }
  50% {
    box-shadow: 0 0 0 8px rgba(16, 185, 129, 0.15);
  }
}

/* Slide out para delete */
@keyframes anim-slide-out-right {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(100px);
  }
}

@keyframes anim-slide-out-left {
  from {
    opacity: 1;
    transform: translateX(0);
  }
  to {
    opacity: 0;
    transform: translateX(-100px);
  }
}

/* Fly - Vídeo "voa" para playlist destino */
@keyframes anim-fly-to-target {
  0% {
    opacity: 1;
    transform: scale(1) translateX(0) translateY(0);
  }
  30% {
    opacity: 1;
    transform: scale(0.9) translateX(20px) translateY(-10px);
  }
  100% {
    opacity: 0;
    transform: scale(0.3) translateX(200px) translateY(-50px);
  }
}

/* Collapse para remoção */
@keyframes anim-collapse {
  from {
    opacity: 1;
    max-height: 200px;
    padding-top: var(--space-4);
    padding-bottom: var(--space-4);
    margin-bottom: var(--space-2);
  }
  to {
    opacity: 0;
    max-height: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin-bottom: 0;
  }
}

/* Pop para confirmações */
@keyframes anim-pop {
  0% {
    transform: scale(0.8);
    opacity: 0;
  }
  50% {
    transform: scale(1.05);
  }
  100% {
    transform: scale(1);
    opacity: 1;
  }
}

/* Check mark animado */
@keyframes anim-check {
  0% {
    stroke-dashoffset: 50;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* Flash para scan success */
@keyframes anim-flash {
  0% {
    opacity: 0;
  }
  20% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

/* Partículas emanando */
@keyframes anim-particle-burst {
  0% {
    opacity: 1;
    transform: scale(0) translate(0, 0);
  }
  100% {
    opacity: 0;
    transform: scale(1) translate(var(--particle-x, 20px), var(--particle-y, -20px));
  }
}

/* ==========================================
 * KEYFRAMES BASE - LOOPS/CONTÍNUAS
 * ========================================== */

/* Pulse genérico */
@keyframes anim-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

/* Pulse com escala */
@keyframes anim-pulse-scale {
  0%, 100% {
    transform: scale(1);
    opacity: 1;
  }
  50% {
    transform: scale(1.05);
    opacity: 0.8;
  }
}

/* Glow pulsante */
@keyframes anim-glow-pulse {
  0%, 100% {
    box-shadow: 0 0 0 0 var(--glow-color, rgba(255, 255, 255, 0.2));
  }
  50% {
    box-shadow: 0 0 20px 5px var(--glow-color, rgba(255, 255, 255, 0.2));
  }
}

/* Scan line */
@keyframes anim-scan-line {
  0%, 100% {
    top: 10%;
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    top: 90%;
    opacity: 0;
  }
}

/* Spin */
@keyframes anim-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

/* Bounce suave */
@keyframes anim-bounce-subtle {
  0%, 100% {
    transform: translateY(0);
  }
  50% {
    transform: translateY(-4px);
  }
}

/* ==========================================
 * CLASSES UTILITÁRIAS - ENTRADA
 * ========================================== */

/* Fade simples */
.animate-fade-in {
  animation: anim-fade-in var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.animate-fade-out {
  animation: anim-fade-out var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

/* Fade com direção */
.animate-in-up {
  opacity: 0;
  animation: anim-fade-in-up var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.animate-in-down {
  opacity: 0;
  animation: anim-fade-in-down var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.animate-in-left {
  opacity: 0;
  animation: anim-fade-in-left var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.animate-in-right {
  opacity: 0;
  animation: anim-fade-in-right var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

/* Scale */
.animate-scale-in {
  opacity: 0;
  animation: anim-scale-in var(--anim-duration-normal) var(--ease-out-back) forwards;
}

.animate-scale-in-center {
  opacity: 0;
  animation: anim-scale-in-center var(--anim-duration-slow) var(--ease-spring) forwards;
}

/* Unfold (Launcher) */
.animate-unfold {
  opacity: 0;
  animation: anim-unfold 0.6s var(--ease-out-quint) forwards;
}

/* Wave (YTPM) */
.animate-wave {
  opacity: 0;
  animation: anim-wave var(--anim-duration-slow) var(--ease-out-quint) forwards;
}

/* Pop */
.animate-pop {
  animation: anim-pop var(--anim-duration-normal) var(--ease-spring) forwards;
}

/* ==========================================
 * CLASSES UTILITÁRIAS - FEEDBACK
 * ========================================== */

/* Shake */
.animate-shake {
  animation: anim-shake var(--anim-duration-slow) var(--ease-out-quint);
}

.animate-shake-subtle {
  animation: anim-shake-subtle var(--anim-duration-normal) var(--ease-out-quint);
}

/* Error feedback */
.animate-error {
  animation:
    anim-shake var(--anim-duration-slow) var(--ease-out-quint),
    anim-error-pulse var(--anim-duration-slower) ease-out;
}

/* Success feedback */
.animate-success {
  animation: anim-success-pulse var(--anim-duration-slower) ease-out;
}

/* Slide out */
.animate-slide-out-right {
  animation: anim-slide-out-right var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.animate-slide-out-left {
  animation: anim-slide-out-left var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

/* Fly (transfer) */
.animate-fly {
  animation: anim-fly-to-target 0.6s var(--ease-out-quint) forwards;
}

/* Collapse */
.animate-collapse {
  animation: anim-collapse var(--anim-duration-normal) var(--ease-out-quint) forwards;
  overflow: hidden;
}

/* Flash */
.animate-flash {
  animation: anim-flash var(--anim-duration-slow) ease-out;
}

/* ==========================================
 * CLASSES UTILITÁRIAS - LOOPS
 * ========================================== */

.animate-pulse {
  animation: anim-pulse 2s ease-in-out infinite;
}

.animate-pulse-scale {
  animation: anim-pulse-scale 2s ease-in-out infinite;
}

.animate-glow {
  animation: anim-glow-pulse 2s ease-in-out infinite;
}

.animate-spin {
  animation: anim-spin 1s linear infinite;
}

.animate-bounce {
  animation: anim-bounce-subtle 1s ease-in-out infinite;
}

/* ==========================================
 * STAGGER DELAYS
 * ========================================== */

/* Stagger padrão (80ms) */
.stagger-1 { animation-delay: calc(var(--stagger-step) * 1); }
.stagger-2 { animation-delay: calc(var(--stagger-step) * 2); }
.stagger-3 { animation-delay: calc(var(--stagger-step) * 3); }
.stagger-4 { animation-delay: calc(var(--stagger-step) * 4); }
.stagger-5 { animation-delay: calc(var(--stagger-step) * 5); }
.stagger-6 { animation-delay: calc(var(--stagger-step) * 6); }
.stagger-7 { animation-delay: calc(var(--stagger-step) * 7); }
.stagger-8 { animation-delay: calc(var(--stagger-step) * 8); }

/* Stagger rápido (50ms) */
.stagger-fast-1 { animation-delay: calc(var(--stagger-step-fast) * 1); }
.stagger-fast-2 { animation-delay: calc(var(--stagger-step-fast) * 2); }
.stagger-fast-3 { animation-delay: calc(var(--stagger-step-fast) * 3); }
.stagger-fast-4 { animation-delay: calc(var(--stagger-step-fast) * 4); }
.stagger-fast-5 { animation-delay: calc(var(--stagger-step-fast) * 5); }
.stagger-fast-6 { animation-delay: calc(var(--stagger-step-fast) * 6); }

/* Stagger lento (120ms) */
.stagger-slow-1 { animation-delay: calc(var(--stagger-step-slow) * 1); }
.stagger-slow-2 { animation-delay: calc(var(--stagger-step-slow) * 2); }
.stagger-slow-3 { animation-delay: calc(var(--stagger-step-slow) * 3); }
.stagger-slow-4 { animation-delay: calc(var(--stagger-step-slow) * 4); }

/* Container com stagger automático para filhos */
.stagger-children > * {
  opacity: 0;
  animation: anim-fade-in-up var(--anim-duration-normal) var(--ease-out-quint) forwards;
}

.stagger-children > *:nth-child(1) { animation-delay: calc(var(--stagger-step) * 1); }
.stagger-children > *:nth-child(2) { animation-delay: calc(var(--stagger-step) * 2); }
.stagger-children > *:nth-child(3) { animation-delay: calc(var(--stagger-step) * 3); }
.stagger-children > *:nth-child(4) { animation-delay: calc(var(--stagger-step) * 4); }
.stagger-children > *:nth-child(5) { animation-delay: calc(var(--stagger-step) * 5); }
.stagger-children > *:nth-child(6) { animation-delay: calc(var(--stagger-step) * 6); }
.stagger-children > *:nth-child(7) { animation-delay: calc(var(--stagger-step) * 7); }
.stagger-children > *:nth-child(8) { animation-delay: calc(var(--stagger-step) * 8); }
.stagger-children > *:nth-child(9) { animation-delay: calc(var(--stagger-step) * 9); }
.stagger-children > *:nth-child(10) { animation-delay: calc(var(--stagger-step) * 10); }

/* ==========================================
 * HOVER STATES DISTINTIVOS
 * ========================================== */

/* Lift - Elevação suave */
.hover-lift {
  transition:
    transform var(--anim-duration-normal) var(--ease-out-quint),
    box-shadow var(--anim-duration-normal) ease;
}

.hover-lift:hover {
  transform: translateY(-4px);
  box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.2);
}

/* Grow - Escala suave */
.hover-grow {
  transition: transform var(--anim-duration-normal) var(--ease-out-quint);
}

.hover-grow:hover {
  transform: scale(1.02);
}

/* Glow - Brilho ao hover */
.hover-glow {
  transition:
    box-shadow var(--anim-duration-normal) ease,
    border-color var(--anim-duration-fast) ease;
}

.hover-glow:hover {
  box-shadow: 0 0 20px -5px var(--glow-color, rgba(255, 255, 255, 0.2));
}

/* Perspective - Rotação 3D editorial */
.hover-perspective {
  transition: transform var(--anim-duration-slow) var(--ease-out-quint);
  transform-style: preserve-3d;
}

.hover-perspective:hover {
  transform: perspective(1000px) rotateY(2deg) translateY(-4px);
}

/* Card industrial (YTPM style) */
.hover-industrial {
  transition:
    transform var(--anim-duration-normal) var(--ease-out-quint),
    box-shadow var(--anim-duration-normal) ease;
}

.hover-industrial:hover {
  transform: translateY(-4px) scale(1.02);
  box-shadow:
    0 20px 40px -12px rgba(255, 0, 51, 0.25),
    0 0 0 1px rgba(255, 0, 51, 0.1);
}

/* Minimal (Scanner style) */
.hover-minimal {
  transition:
    background-color var(--anim-duration-fast) ease,
    border-color var(--anim-duration-fast) ease;
}

.hover-minimal:hover {
  background-color: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.12);
}

/* Arrow slide - Para links com seta */
.hover-arrow-slide {
  transition: transform var(--anim-duration-normal) var(--ease-out-quint);
}

.group:hover .hover-arrow-slide {
  transform: translateX(4px);
}

/* ==========================================
 * TRANSITION UTILITIES
 * ========================================== */

.transition-none { transition: none; }
.transition-all { transition: all var(--anim-duration-normal) var(--ease-out-quint); }
.transition-colors { transition: color, background-color, border-color var(--anim-duration-fast) ease; }
.transition-opacity { transition: opacity var(--anim-duration-normal) ease; }
.transition-transform { transition: transform var(--anim-duration-normal) var(--ease-out-quint); }

/* ==========================================
 * MOTION SAFE & REDUCED MOTION
 * ========================================== */

/* Animações apenas quando motion é permitido */
@media (prefers-reduced-motion: no-preference) {
  .motion-safe\:animate-in-up {
    opacity: 0;
    animation: anim-fade-in-up var(--anim-duration-normal) var(--ease-out-quint) forwards;
  }

  .motion-safe\:animate-wave {
    opacity: 0;
    animation: anim-wave var(--anim-duration-slow) var(--ease-out-quint) forwards;
  }

  .motion-safe\:animate-unfold {
    opacity: 0;
    animation: anim-unfold 0.6s var(--ease-out-quint) forwards;
  }
}

/* Desabilitar animações para usuários que preferem motion reduzido */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }

  /* Garantir visibilidade de elementos animados */
  .animate-fade-in,
  .animate-in-up,
  .animate-in-down,
  .animate-in-left,
  .animate-in-right,
  .animate-scale-in,
  .animate-scale-in-center,
  .animate-unfold,
  .animate-wave,
  .animate-pop,
  .stagger-children > * {
    opacity: 1 !important;
    transform: none !important;
    animation: none !important;
  }

  /* Manter feedback visual sem animação */
  .hover-lift:hover,
  .hover-grow:hover,
  .hover-perspective:hover,
  .hover-industrial:hover {
    transform: none;
  }

  /* Substituir por outline em reduced motion */
  .hover-glow:hover,
  .hover-industrial:hover {
    outline: 2px solid var(--glow-color, currentColor);
    outline-offset: 2px;
  }
}

/* ==========================================
 * INTERSECTION OBSERVER HELPERS
 * ========================================== */

/* Elementos que aguardam entrada no viewport */
.animate-on-scroll {
  opacity: 0;
}

.animate-on-scroll.is-visible {
  animation: anim-fade-in-up var(--anim-duration-slow) var(--ease-out-quint) forwards;
}

.animate-on-scroll.is-visible.animate-unfold-style {
  animation: anim-unfold 0.6s var(--ease-out-quint) forwards;
}

.animate-on-scroll.is-visible.animate-wave-style {
  animation: anim-wave var(--anim-duration-slow) var(--ease-out-quint) forwards;
}

/* ==========================================
 * LOADING STATES
 * ========================================== */

/* Skeleton loading */
@keyframes anim-skeleton {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.skeleton {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.03) 0%,
    rgba(255, 255, 255, 0.08) 50%,
    rgba(255, 255, 255, 0.03) 100%
  );
  background-size: 200% 100%;
  animation: anim-skeleton 1.5s ease-in-out infinite;
}

/* Spinner */
.spinner {
  width: 1.5rem;
  height: 1.5rem;
  border: 2px solid transparent;
  border-top-color: currentColor;
  border-radius: 50%;
  animation: anim-spin 0.8s linear infinite;
}

/* Loading dots */
@keyframes anim-loading-dots {
  0%, 80%, 100% {
    transform: scale(0.6);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

.loading-dots > span {
  display: inline-block;
  width: 0.5rem;
  height: 0.5rem;
  margin: 0 0.125rem;
  background: currentColor;
  border-radius: 50%;
  animation: anim-loading-dots 1.4s ease-in-out infinite;
}

.loading-dots > span:nth-child(1) { animation-delay: 0s; }
.loading-dots > span:nth-child(2) { animation-delay: 0.16s; }
.loading-dots > span:nth-child(3) { animation-delay: 0.32s; }
